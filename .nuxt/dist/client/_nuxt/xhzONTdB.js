import{_ as V}from"./DeMLfEu4.js";import{e as A,i as u,r as G,z as F,m as z,w as q,o as p,a as t,c as m,k as v,x as b,g as s,j as H,l as h,v as C,n as B,t as i,b as N,F as J,s as K}from"./Cuvv8fMg.js";import{r as W}from"./BOs-63Ba.js";const Q={class:"space-y-6"},X={class:"flex space-x-4 mb-6"},Y={key:0,class:"card p-6"},Z={class:"md:col-span-2"},tt={class:"md:col-span-2"},et=["disabled"],st={key:0,class:"mt-6 p-4 bg-red-500/20 border border-red-500/50 rounded-lg"},ot={class:"text-red-300"},at={key:1,class:"mt-6 p-4 bg-gray-700/50 rounded-lg"},lt={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},it={class:"text-center"},nt={class:"text-center"},rt={class:"text-center"},dt={class:"text-center"},ct={class:"text-2xl font-bold text-blue-400"},ut={key:1,class:"space-y-6"},pt={class:"card p-6"},gt={class:"border-2 border-dashed border-gray-600 rounded-lg p-8 text-center"},mt={key:0,class:"mt-4 p-4 bg-gray-700/50 rounded-lg"},bt={class:"flex items-center justify-between"},xt={class:"font-medium text-white"},yt={class:"text-sm text-gray-400"},ft=["disabled"],vt={key:0,class:"card p-6"},_t={class:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6"},ht={class:"text-center p-4 bg-gray-700/50 rounded-lg"},kt={class:"text-2xl font-bold text-blue-400"},wt={class:"text-center p-4 bg-gray-700/50 rounded-lg"},St={class:"text-2xl font-bold text-green-400"},Rt={class:"text-center p-4 bg-gray-700/50 rounded-lg"},Ft={class:"text-2xl font-bold text-red-400"},Ct={class:"text-center p-4 bg-gray-700/50 rounded-lg"},Mt={class:"text-2xl font-bold text-yellow-400"},Bt={class:"text-center p-4 bg-gray-700/50 rounded-lg"},It={class:"text-2xl font-bold text-purple-400"},Pt={class:"overflow-x-auto"},Ut={class:"w-full text-sm"},jt={class:"py-3 text-blue-400"},Lt={class:"py-3 text-gray-300"},Tt={class:"py-3"},$t={class:"py-3"},Dt={class:"py-3"},Ot={class:"flex items-center justify-between mt-6"},Et={class:"text-sm text-gray-400"},Vt={class:"flex space-x-2"},At=["disabled"],Gt=["disabled"],I="http://localhost:8000",k=10,Jt=A({__name:"prediction",setup(zt){const y=u("single"),w=u(!1),S=u(!1),f=u(null),P=u(),x=u(""),n=G({amt:"",category:"",merchant:"",gender:"",job:""}),d=u(null),c=u([]),g=u(1),R=u({total:0,fraud:0,legitimate:0,high_risk:0,fraud_rate:0,average_fraud_probability:0}),_=F(()=>R.value),U=F(()=>Math.ceil(c.value.length/k)),j=F(()=>{const l=(g.value-1)*k,e=l+k;return c.value.slice(l,e)}),L=async()=>{var l;w.value=!0,x.value="",d.value=null;try{const e={amt:parseFloat(n.amt),category:n.category,merchant:n.merchant,gender:n.gender,job:n.job},a=await $fetch(`${I}/predict`,{method:"POST",headers:{"Content-Type":"application/json"},body:e});d.value=a}catch(e){x.value=((l=e.data)==null?void 0:l.detail)||e.message||"An error occurred while making the prediction",console.error("Prediction error:",e)}finally{w.value=!1}},T=l=>{const e=l.target;e.files&&e.files[0]&&(f.value=e.files[0],x.value="")},$=async()=>{var l;if(f.value){S.value=!0,x.value="";try{const e=new FormData;e.append("file",f.value);const a=await $fetch(`${I}/predict/batch`,{method:"POST",body:e});c.value=a.predictions.map((o,r)=>({...o,amt:0,originalIndex:r})),R.value={total:a.summary.total_transactions||a.predictions.length,fraud:a.summary.fraud_detected||a.predictions.filter(o=>o.is_fraud).length,legitimate:(a.summary.total_transactions||a.predictions.length)-(a.summary.fraud_detected||a.predictions.filter(o=>o.is_fraud).length),high_risk:a.summary.high_risk_transactions||a.predictions.filter(o=>o.risk_level==="HIGH").length,fraud_rate:a.summary.fraud_rate||0,average_fraud_probability:a.summary.average_fraud_probability||0},g.value=1}catch(e){x.value=((l=e.data)==null?void 0:l.detail)||e.message||"An error occurred while processing the batch",console.error("Batch processing error:",e)}finally{S.value=!1}}},D=l=>{if(l===0)return"0 Bytes";const e=1024,a=["Bytes","KB","MB"],o=Math.floor(Math.log(l)/Math.log(e));return parseFloat((l/Math.pow(e,o)).toFixed(2))+" "+a[o]},M=l=>{switch(l){case"LOW":return"text-green-400";case"MEDIUM":return"text-yellow-400";case"HIGH":return"text-red-400";default:return"text-gray-400"}},O=()=>{if(c.value.length===0)return;const l=["transaction_id,row_number,is_fraud,fraud_probability,risk_level",...c.value.map(r=>`${r.transaction_id},${r.originalIndex+1},${r.is_fraud},${r.fraud_probability},${r.risk_level}`)].join(`
`),e=new Blob([l],{type:"text/csv"}),a=URL.createObjectURL(e),o=document.createElement("a");o.href=a,o.download=`fraud_predictions_${new Date().toISOString().split("T")[0]}.csv`,o.click(),URL.revokeObjectURL(a)},E=()=>{if(c.value.length===0)return;const l={generated_at:new Date().toISOString(),summary:R.value,total_predictions:c.value.length,results:c.value.map(r=>({transaction_id:r.transaction_id,row_number:r.originalIndex+1,is_fraud:r.is_fraud,fraud_probability:r.fraud_probability,risk_level:r.risk_level}))},e=new Blob([JSON.stringify(l,null,2)],{type:"application/json"}),a=URL.createObjectURL(e),o=document.createElement("a");o.href=a,o.download=`fraud_detection_report_${new Date().toISOString().split("T")[0]}.json`,o.click(),URL.revokeObjectURL(a)};return(l,e)=>{const a=V;return p(),z(a,{name:"default"},{default:q(()=>[t("div",Q,[t("div",X,[t("button",{onClick:e[0]||(e[0]=o=>y.value="single"),class:b(s(y)==="single"?"btn-primary":"btn-secondary")}," Single Prediction ",2),t("button",{onClick:e[1]||(e[1]=o=>y.value="batch"),class:b(s(y)==="batch"?"btn-primary":"btn-secondary")}," Batch Prediction ",2)]),s(y)==="single"?(p(),m("div",Y,[e[23]||(e[23]=t("h2",{class:"text-xl font-semibold text-white mb-6"},"Single Transaction Prediction",-1)),t("form",{onSubmit:H(L,["prevent"]),class:"grid grid-cols-1 md:grid-cols-2 gap-6"},[t("div",null,[e[10]||(e[10]=t("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Transaction Amount",-1)),h(t("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>s(n).amt=o),type:"number",step:"0.01",class:"input-field w-full",placeholder:"0.00",required:""},null,512),[[C,s(n).amt]])]),t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Category",-1)),h(t("select",{"onUpdate:modelValue":e[3]||(e[3]=o=>s(n).category=o),class:"input-field w-full",required:""},e[11]||(e[11]=[t("option",{value:""},"Select category",-1),t("option",{value:"personal_care"},"Personal Care",-1),t("option",{value:"health_fitness"},"Health & Fitness",-1),t("option",{value:"food_dining"},"Food & Dining",-1),t("option",{value:"gas_transport"},"Gas & Transport",-1),t("option",{value:"entertainment"},"Entertainment",-1),t("option",{value:"shopping_net"},"Online Shopping",-1),t("option",{value:"grocery_net"},"Online Grocery",-1),t("option",{value:"grocery_pos"},"Grocery Store",-1),t("option",{value:"shopping_pos"},"Retail Shopping",-1),t("option",{value:"misc_net"},"Miscellaneous Online",-1),t("option",{value:"misc_pos"},"Miscellaneous Retail",-1)]),512),[[B,s(n).category]])]),t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Merchant",-1)),h(t("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>s(n).merchant=o),type:"text",class:"input-field w-full",placeholder:"Merchant name",required:""},null,512),[[C,s(n).merchant]])]),t("div",null,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Gender",-1)),h(t("select",{"onUpdate:modelValue":e[5]||(e[5]=o=>s(n).gender=o),class:"input-field w-full",required:""},e[14]||(e[14]=[t("option",{value:""},"Select gender",-1),t("option",{value:"M"},"Male",-1),t("option",{value:"F"},"Female",-1)]),512),[[B,s(n).gender]])]),t("div",Z,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-300 mb-2"},"Job",-1)),h(t("input",{"onUpdate:modelValue":e[6]||(e[6]=o=>s(n).job=o),type:"text",class:"input-field w-full",placeholder:"Job title",required:""},null,512),[[C,s(n).job]])]),t("div",tt,[t("button",{type:"submit",disabled:s(w),class:"btn-primary disabled:opacity-50"},i(s(w)?"Analyzing...":"Predict Fraud Risk"),9,et)])],32),s(x)?(p(),m("div",st,[e[17]||(e[17]=t("h3",{class:"text-lg font-semibold text-red-400 mb-2"},"Error",-1)),t("p",ot,i(s(x)),1)])):v("",!0),s(d)?(p(),m("div",at,[e[22]||(e[22]=t("h3",{class:"text-lg font-semibold text-white mb-4"},"Prediction Result",-1)),t("div",lt,[t("div",it,[t("div",{class:b([s(d).is_fraud?"text-red-400":"text-green-400","text-2xl font-bold"])},i(s(d).is_fraud?"FRAUD":"LEGITIMATE"),3),e[18]||(e[18]=t("div",{class:"text-sm text-gray-400"},"Classification",-1))]),t("div",nt,[t("div",{class:b([s(d).fraud_probability>.7?"text-red-400":s(d).fraud_probability>.4?"text-yellow-400":"text-green-400","text-2xl font-bold"])},i((s(d).fraud_probability*100).toFixed(1))+"% ",3),e[19]||(e[19]=t("div",{class:"text-sm text-gray-400"},"Fraud Probability",-1))]),t("div",rt,[t("div",{class:b([M(s(d).risk_level),"text-2xl font-bold"])},i(s(d).risk_level),3),e[20]||(e[20]=t("div",{class:"text-sm text-gray-400"},"Risk Level",-1))]),t("div",dt,[t("div",ct,i(s(d).transaction_id.substring(0,8))+"... ",1),e[21]||(e[21]=t("div",{class:"text-sm text-gray-400"},"Transaction ID",-1))])])])):v("",!0)])):v("",!0),s(y)==="batch"?(p(),m("div",ut,[t("div",pt,[e[27]||(e[27]=t("h2",{class:"text-xl font-semibold text-white mb-6"},"Batch Prediction",-1)),t("div",gt,[N(s(W),{class:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e[24]||(e[24]=t("h3",{class:"text-lg font-medium text-white mb-2"},"Upload CSV File",-1)),e[25]||(e[25]=t("p",{class:"text-gray-400 mb-4"},"CSV should contain columns: amt, category, merchant, gender, job",-1)),t("input",{type:"file",onChange:T,accept:".csv",class:"hidden",ref_key:"fileInput",ref:P},null,544),t("button",{onClick:e[7]||(e[7]=o=>l.$refs.fileInput.click()),class:"btn-primary"}," Choose File "),e[26]||(e[26]=t("p",{class:"text-sm text-gray-500 mt-2"}," Supports CSV files up to 50MB ",-1))]),s(f)?(p(),m("div",mt,[t("div",bt,[t("div",null,[t("p",xt,i(s(f).name),1),t("p",yt,i(D(s(f).size)),1)]),t("button",{onClick:$,disabled:s(S),class:"btn-primary disabled:opacity-50"},i(s(S)?"Processing...":"Process Batch"),9,ft)])])):v("",!0)]),s(c).length>0?(p(),m("div",vt,[t("div",{class:"flex items-center justify-between mb-6"},[e[28]||(e[28]=t("h3",{class:"text-lg font-semibold text-white"},"Batch Results",-1)),t("div",{class:"flex space-x-2"},[t("button",{onClick:O,class:"btn-secondary text-sm"},"Export Results"),t("button",{onClick:E,class:"btn-primary text-sm"},"Download Report")])]),t("div",_t,[t("div",ht,[t("div",kt,i(s(_).total),1),e[29]||(e[29]=t("div",{class:"text-sm text-gray-400"},"Total Processed",-1))]),t("div",wt,[t("div",St,i(s(_).legitimate),1),e[30]||(e[30]=t("div",{class:"text-sm text-gray-400"},"Legitimate",-1))]),t("div",Rt,[t("div",Ft,i(s(_).fraud),1),e[31]||(e[31]=t("div",{class:"text-sm text-gray-400"},"Fraud Detected",-1))]),t("div",Ct,[t("div",Mt,i(s(_).high_risk),1),e[32]||(e[32]=t("div",{class:"text-sm text-gray-400"},"High Risk",-1))]),t("div",Bt,[t("div",It,i((s(_).fraud_rate*100).toFixed(1))+"%",1),e[33]||(e[33]=t("div",{class:"text-sm text-gray-400"},"Fraud Rate",-1))])]),t("div",Pt,[t("table",Ut,[e[34]||(e[34]=t("thead",null,[t("tr",{class:"border-b border-gray-700"},[t("th",{class:"text-left py-3 text-gray-400"},"Transaction ID"),t("th",{class:"text-left py-3 text-gray-400"},"Row #"),t("th",{class:"text-left py-3 text-gray-400"},"Fraud Probability"),t("th",{class:"text-left py-3 text-gray-400"},"Risk Level"),t("th",{class:"text-left py-3 text-gray-400"},"Classification")])],-1)),t("tbody",null,[(p(!0),m(J,null,K(s(j),o=>(p(),m("tr",{key:o.transaction_id,class:"border-b border-gray-700/50"},[t("td",jt,i(o.transaction_id.substring(0,8))+"...",1),t("td",Lt,i(o.originalIndex+1),1),t("td",Tt,[t("span",{class:b(o.fraud_probability>.7?"text-red-400":o.fraud_probability>.4?"text-yellow-400":"text-green-400")},i((o.fraud_probability*100).toFixed(1))+"% ",3)]),t("td",$t,[t("span",{class:b([M(o.risk_level),"px-2 py-1 rounded-full text-xs"])},i(o.risk_level),3)]),t("td",Dt,[t("span",{class:b([o.is_fraud?"bg-red-500/20 text-red-400":"bg-green-500/20 text-green-400","px-2 py-1 rounded-full text-xs"])},i(o.is_fraud?"FRAUD":"LEGITIMATE"),3)])]))),128))])])]),t("div",Ot,[t("div",Et," Showing "+i((s(g)-1)*k+1)+" to "+i(Math.min(s(g)*k,s(c).length))+" of "+i(s(c).length)+" results ",1),t("div",Vt,[t("button",{onClick:e[8]||(e[8]=o=>g.value--),disabled:s(g)<=1,class:"btn-secondary text-sm disabled:opacity-50"}," Previous ",8,At),t("button",{onClick:e[9]||(e[9]=o=>g.value++),disabled:s(g)>=s(U),class:"btn-secondary text-sm disabled:opacity-50"}," Next ",8,Gt)])])])):v("",!0)])):v("",!0)])]),_:1})}}});export{Jt as default};
